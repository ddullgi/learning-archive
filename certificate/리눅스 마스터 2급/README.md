# 리눅스 마스터 2급 정리

## 권한 및 그룹 삭제

### 소유권과 관련된 명령어

- chown
  - `chown [옵션][:그룹명] 파일명` 그룹 명 앞에 콜론(:)을 붙여 사용자 소유권과 그룹 소유권을 분리
  - 옵션 `-R`: 하위 디렉터리 포함
- chgrp
  - `chgrp -h`: 심볼릭 링크 파일 그룹 소유권 변경

### 허가권과 관련된 명령어

- chmod
  - 소유자(owner): `u`
  - 그룹(group): `g`
  - 기타 사용자(others 혹은 public): `o`
  - 모든 사용자: `a`
- umask
  - 옵션 `-S`: umask 값을 u,g,o와 w,r,x와 같은 문자로 나타냄
  - 기본 권한: 파일(666), 디렉터리(777)
  - umask 명령시 출력되는 값 : 기본 권한 - umask = 디렉터리(파일)의 허가권 값
- 권한 설정
  - r(4) 읽기, w(2) 쓰기, x(1) 실행

### 특수 권한

- `setUID`: 사용자가 사용할 때만 소유자 권한으로 파일을 실행
- `setGID`: 사용자가 사용할 때만 그룹 권한으로 파일 실행
- `sticky bit`: 권한 기호 't', /tmp 폴더는 sticky-bit가 설정되어 있음.

### 디스크 쿼터

- 정의: 파일 시스템마다 사용자/그룹을 생성할 수 있는 파일 용량/개수 제한
- `edquota`: 편집기(editor)를 사용하여 그룹에 디스크 사용량 할당
  - 사용 예: `edquota -p bookmark ihd`
  - 옵션 `-p`: 디스크 할당량 설정을 다른 사용자와 동일하게 설정 (bookmark를 ihd와 동일하게)
- `setquota`: 명령 행에서 직접 디스크 사용량 할당
  - 사용 예: `setquota -u ihd 20M 30M 0 0 /home`
    - 설명: setquota -u 계정명 [블록soft] [블록hard] [inode soft] [inode hard]

### 참고

- 심볼릭 링크 파일 `l`, 블록 파일 `b`, 소켓파일 `s`, 입출력 파일 `c`로 기호화 함
- 파일을 생성 또는 삭제할 수 없는 권한 표시는 하이픈(-)을 사용함

## 파일 시스템의 관리

### 파일 시스템 개요 및 종류

- ext2: 255까지 파일이름, 2GB 단일 파일, 4TB 디스크 (저널링 기능 없음)
- ext3: ext2 확장, 저널링 기능, ACL(Access Control List)
- nfs: 네트워크 파일 시스템, 파일 공유 및 파일 서버
- cifs: SMB의 확장
- NTFS: 윈도우에서 사용하는 파일 시스템, 대용량 파일 저장 가능
- udf: DVD 파일 시스템, 배포판 리눅스에서 iso9660으로 지정해도 마운트할 수 있는 파일 시스템
- 대표적 저널링 파일 시스템: FJS, XFS, ReiserFS, ext3

### JFS

- IBM사가 개발한 저널링 파일 시스템

### 관련 명령어

- `mount`: 장치와 디렉터리 연결
- `umount`: 연결된 장치, 디렉터리 연결 해제
  - floppy, usb메모리 등의 보조 기억 장치 사용 후에는 반드시 이 명령을 사용한 뒤에 제거해야 데이터 손실이 없음
- `eject`: 이동식 보조 기억 장치 제거
- `fdisk`: 파티션 생성,삭제,타입 결정
  - 옵션 `-l`: 현재 디스크의 파티션 테이블 정보를 나타냄
  - 옵션 `-v`: fdisk 버전(version)을 나타냄
  - 옵션 `-t`: 파일 시스템 유형(type) 결정
  - 옵션 `-s`: 파티션 크기(size)
- `mkfs`: 마운트 정보 파일 시스템 정보 확인
- `mke2fs`: 파일 시스템 생성(포맷), ext2/ext3/ext4
- `fsck`: 파일 시스템 검사, 수리
  - `s`: 동작을 시리얼화, 대화형 모드로 파일 시스템 점검 시 유용
  - `/lost+found`: 디렉터리에서 작업 수행
  - `/etc/fstab`에서 `6번째` 자리 값과 연관 있음
- `e2fsck`: 파일 시스템 점검 및 복구하는 명령 (ext2,ext3,ext4)
  - 옵션 `-b`: 파일 시스템의 블록 사이즈를 정함
  - 옵션 `-R`: stride는 RAID 장치에 적합한 데이터 구조를 만듬
- `du`(disk usage): 디렉터리 별 디스크 사용량 확인
  - 옵션 `-s`: 파일들의 전체 크기를 합한 값
  - 옵션 `-h` 용량 단위(KB,MB,GB)로 표시
- `df`: 시스템에 마운트 된 하드 디스크의 남은 용량 확인할 때 사용 (분할 된 파티션 별로 사용량 확인)
  - 옵션 `-T`: 해당 파티션의 파일 시스템 유형(type) 확인
  - 옵션 `-h`: 디스크 용량 단위(KB,MB,GB)를 사람이 읽기 쉽게 표기
  - 옵션 `-a`: 0 블록의 파일 시스템을 포함하여 모든 파일 시스템을 나타냄

### /etc/fstab

- 리눅스에서 사용하는 파일 시스템 정적 정보 저장

### blkid

- 현재 하드디스크의 파티션의 UUID 와 파일 시스템 정보를 확인할 수 있음

## 개념 및 종류

### 본셸(Bourne shell) 계열

- 본셸: `/bin/sh`, 벨 연구소 스티븐 본 개발
- 콘셸: `/bin/ksh`, AT&T 데이비드 콘
- 배쉬셸: `/bin/bash`, 본셸 기반으로 GNU 프로젝트에 의해 개발
- 지셸: `/bin/zsh`

### C셸 계열

- C셸: `/bin/csh`, 버클리 대학 빌 조이, C언어 기반
- tcsh셸: `/bin/tcsh`, 확장 C셸

### 셸 확인

- 로그인 셸 확인: `/etc/shells`
- 파일: `/etc/passwd`
- 명령어: `echo $SHELL`

### 셸 변경 명령어

- `chsh`: 일반 사용자 환경에서 셸 변경 (change shell)
- `usermod`: 계정의 정보를 변경할 때 사용
  - 관리자가 셸 변경 후 다음 변경 전까지 해당 셸을 반 영구적으로 사용
  - `usermod -s /bin/bash ihd`: 지정된 계정의 설정을 변경하기 위한 명령어

### 셸 확인 방법

- `echo $SHELL`: 시스템에 로그인 후 사용 중인 셸 확인
- `chsh -l`
  - `/etc/shells`의 파일 안의 지정된 셸 들을 나열
  - 시스템에서 사용 가능한 셸(shell) 목록을 확인하는 명령어
- `cat /etc/shell`’: 현재 시스템에서 사용할 수 있는 셸들을 확인

## 환경 설정

### 주요 환경 변수

- `TERM`: 터미널 종류의 이름
- `TMOUT`: 로그아웃 관련 시간 제어
- `LANG`: 프로그램 사용 시 기본 지원 언어

### 환경 설정 파일

- 전역 설정 파일: `/etc/profile`, `/etc/bashrc`
- 지역 설정 파일: `~/.bash_profile`, `~/.bash_history`, `~/.bashrc`, `~/.bash_logout`
- `/etc/profile.d`: 몇몇 응용 프로그램들이 시작 시 자동 실행할 스크립트 파일 경로를 넣어 둠

### 셸 환경변수

- `/etc/profile`: 모든 사용자의 셸 환경을 제어하는 전역적인 시스템 설정 파일
- `~/.bash_profile`: 일반 사용자가 PATH와 같은 **환경 변수** 변경할 때 사용하는 지역 설정 파
- `~/.bashrc`: 별칭과 bash가 수행 시 실행되는 **함수**를 지역적으로 제어
- `~/.bash_history`: 사용자가 명령어나 키보드로 입력한 내용들을 파일로 모두 기록
- `/etc/profile.d`: 몇몇 응용프로그램들이 시작할 때 필요한 스크립트가 위치하는 디렉터리

### history 기능

- 옵션
  - `!!`: 마지막으로 실행했던 명령문 실행
  - `!문자열`: 가장 최근에 `문자열`로 시작하는 명령문 실행
  - `!?문자열?`: 가장 최근에 `문자열`을 포함하고 있는 단어를 나태 냄
  - `!n`: n번째 명령어 실행
- 환경 변수
  - `HISTSIZE`: 히스토리 스택의 크기
  - `HISTFILE`: 히스토리 파일 위치
  - `HISFILESIZE`: 물리적인 히스토리 파일 크기

### 프롬프트 형식

- PS1=’[/u@ \W]\$’
  - `\h`: 호스트 명을 표시
  - `\u`: 현재 사용자의 이름 표시
  - `\t`: **24시**로 **현재 시간**을 표시
  - `\d`: **`요일 월 일`** 형태로 날짜 표시
  - `\w`: 현재 작업 디렉터리를 절대 경로로 표시
  - `\W`: 현재 작업 디렉터리의 전체 경로 중 마지막 디렉터리만 표시
  - `\s`: 사용 중인 **셸 이름** 표시

## 프로세스 개념 및 유형

### inetd vs standalone

- `inetd`: 필요한 서비스이나 자주 사용하지 않는 서비스들을 관리할 때 유용한 방법으로 특히 메모리 관리에 효율적
- `standalone`: 독립적으로 수행되며 서비스 요청에 응답하기 위해 항상 메모리에 상주 하는 데몬

### 프로세스 유형 fork()와 exec()

- `exec`: 시스템 호출 함수로 호출하는 프로세스가 새로운 프로세스로 변경되는 방식
- `fork`: 시스템 호출 함수로 새로운 프로세스를 만들 때 기본 프로세스를 복제하는 방식

### 명령어

- `halt`:시스템을 종료하는 명령
- `suspend`: 작업 중인 프로세스를 일시 중지 시키는 명령어

### NI 값

- 조정할 수 있는 NI값 범위: -20 ~ 19
- -20은 가장 높은 우선권을 가지며 19는 가장 낮은 우선권을 가짐
- 일반 사용자는 NI값을 증가 시키는 것만 가능, root 사용자만 NI값을 감소 시킬 수 있음

### 시그널 번호

- `SIGINT`: 2, <CTRL+C>, 종료
- `9`: 강제 종료
- `SIGTERM`: 15, kill 시스템 호출 시, 가능하면 정상 종료 시키는 시그널, kill 명령 기본 시그널,
- `SIGTSTP`: 20, <Ctrl+Z>, 프로세스를 대기(suspend)로 전환

### 참고

- /etc/rc.d/init.d/nfs start
- `inetd` 기반 방식
  - 클라이언트 서비스가 요청이 있는 경우 메모리에 상주 하는 것
  - 운영 빈도수가 낮은 프로세스에 설정하는 것이 효율적 (telnet, pop3, finger 서비스가 이에 해당)

## 프로세스 유틸리티(관련 명령어)

### ps(process status)

- 실행 중인 프로세스 상태를 보여줌
- 옵션
  - `a`: 현재 실행 중인 모든 프로세스 출력
  - `u`: 사용자 이름과 프로세스 시작 시간 출력
  - `x`: 접속 된 터미널 뿐만 아니라 사용되고 있는 모든 프로세스들 출력
  - 명령 `ps aux`: 실행 중인 모든 프로세스 정보를 소유자 정보와 함께 출력
- `ps aux`: 현재 시스템 사용자가 사용하고 있는 프로세스의 모든 정보를 확인할 수 있음
- 상태
  - USER(프로세스 소유자)
  - RSS(실제 사용되는 메모리량)
  - TTY(프로세스와 연결된 터미널 번호), TIME(총 CPU 사용 시간)
- STAT 값
  - `S`: 특정 이벤트가 끝나기를 기다리는 상태
  - `Z`: 작업이 종료되었으나 부모 프로세스로부터 회수 되지 않아 메모리를 차지하고 있는 상태
  - `R`: 실행 중 혹은 실행될 수 있는 상태
  - `T`: 정지된 상태
  - `D`: 디스크 I/O에 의해 대기하고 있는 상태

### pstree

- 실행중인 프로세스들을 트리 구조로 나타냄
- 옵션
  - `-p`: 프로세스ID 표시
  - `-a`: 명령행 인자를 포함한 정보를 트리 구조에 표시
  - `h`: 현재 프로세스와 해당 프로세스의 부모 프로세스를 음영으로 강조해서 출력

### jobs

- 작업이 중지된 상태, 백그라운드로 진행중인 상태, 변경되었지만 보고되지 않은 상태 등을 표시
- 출력된 목록 중에서 기호 ‘-’는 대기 상태 작업을 나타냄

### bg와 fg

- 포그라운드에서 백그라운드로의 전환
- 명령어 뒤에 '&'를 붙여주면 백그라운드로 작업
- <ctrl+c>: 포그라운드 작업 종료
- 포그라운드에서 백그라운드로 전환: 먼저 실행 중인 작업을 일시 중지 시킨 후(<ctrl+z>), bg 명령 수행
- fg 형식: `fg %작업번호` 또는 `fg 작업번호`

### kill

- 프로세스를 종료시킴
- 옵션
  - `-l`(시그널 종류 나열)
  - `-1`(`-HUP`과 동일, 프로세스 재 시작)
  - `-9`(프로세스 강제 종료)

### kill all:

- 같은 데몬의 여러 프로세서를 한번에 종료

### nice

- 프로세스 사이의 우선순위를 확인하고 우선순위를 변경할 수 있는 명령
- NI 범위: -20 ~ 19
- 옵션
  - `-숫자`: 사용하지 않으면 디폴트 10
  - ex) `nice -10 bash` (기존NI:-5): 기존 -5 이므로 '-5+(10)=5' 임

### renice

- 이미 실행 중인 프로세스의 우선순위를 변경
- 기존 NI 값에 상관없이 NI값을 설정

### top

- 리눅스 시스템의 운영 상태를 실시간으로 모니터링, 프로세스 상태 확인
  - ex) `top -d 1 -p 4056`: 프로세스 4056의 상태와 시스템 상태 정보를 1초 간격으로 화면에 출력
- 옵션
  - `k`: kill과 동일
  - `n`: 표시되는 프로세스 개수 지정
  - `i`: 좀비 프로세스나 idle 프로세스의 정보 출력 제어
  - `r`: NI값을 조절할 때 사용하는 명령
  - `s`: 화면 갱신 시간 변경
  - `q`: top종료
- 실행 상태에서 `t`키를 입력하면 명령어 라인 항목을 on/off 할 수 있음

### nohup

- 프로세스가 중단되지 않고 백그라운드로 작업을 수행할 수 있게 한다
- 실행 중인 프로세스의 터미널이 닫히더라도 계속적으로 작업이 수행

### tail

- 마지막 행을 기준으로 지정한 행까지 파일 내용의 일부 출력
- 조작 키
  - <ctrl+d>: 진행 중인 작업 정상 종료 또는 shell 상태면 로그아웃
  - <ctrl+c>: 진행 중인 작업 취소
  - <ctrl+z>: 프로세스를 대기

### cron

- 주기적으로 반복되는 일을 자동적으로 실행
- 데몬: `crond`
- 관련 파일: `/etc/crontab`
- 옵션
  - `-e`(crontab을 작성하거나 수정)
  - `-u`(특정 사용자의 일정 수정)

## 에디터 종류 및 활용

### pico

- 워싱턴 대학의 aboil kasar가 개발한 유닉스 기반의 텍스트 에디터, 자유소프트웨어 라이선스가 아님
- 메뉴의 키
  - <ctrl+o>: 파일 저장
  - <ctrl+x>: 파일 종료
  - <ctrl+a>: 커서를 해당 줄 시작으로 이동
  - <ctrl+e>: 커서를 해당 줄 마지막으로 이동

### vi

- 1976년 **빌 조이**가 초기 BSD 릴리즈에 포함될 편집기로 만듬
- **모드**형 편집기 (명령모드, 입력모드, 편집모드로 구성)
- 옵션
  - `-r`: 갑작스러운 사고로 인해 파일이 손상되었을 경우 파일 복구
  - `vi +[num] 파일명`: 해당 줄로 커서 이동, [num]이 없는 경우 마지막 줄로 커서 이동
  - `vi $ 파일명`: 커서가 줄의 맨 끝으로 이동하는 명령,
  - `vi – 파일명`: 앞줄의 첫 문자로 이동
- 문자열 검색
  - `n`: 같은 방향으로 다음 문자열 검색
  - `/정규표현`: 커서 위치 아래 방향으로 검색
- `-/?정규표현`: 커서 위치 윗 방향으로 검색
- 입력 모드 전환 명령
  - `a`, `i`, `o`
  - [참고] 명령 `p`: 명령 모드에서 수행되며 커서 위치 오른쪽에 붙여 넣기를 함
- 명령 모드
  - `삭제할줄번호dd`: 커서 위치부터 아래 줄 삭제
- 편집 모드
  - `p`: 커서 위치 오른쪽에 붙여 넣기
  - `dd`: 한 라인 삭제
  - `yy`: 한 라인 복사
  - `x`: 현 커서 위치 문자를 삭제
- `.exec`: vi편집기 환경 등록 파일:
- set nu: 줄 번호
- 치환할 때 규칙
  - 기호 ’^’: 줄의 시작을 의미
  - 문자열 치환 기호 `s/문자열/새문자열`: 커서가 위치하고 있는 줄의 첫 번째 해당 문자열을 새로운 문자열로 치환

### vim

- 브람 무레나르가 만듦
- 편집 시 다양한 색상을 이용하여 가시성을 높일 수 있음

### gredit

- 그놈 데스크톱 환경용으로 개발된 자유 소프트웨어 텍스트 편집기
- 마이크로소프트 윈도우, 맥OS X에서도 사용

### emacs

- 리차드 스톨만이 매크로 기능이 있는 텍스트 교정 편집기로 개발
- 제임스 고슬링이 LSIP 언어를 기반하여 emacs에 다양한 기능을 개발하여 추가
- 비모드형 편집기로 ctrl 또는 alt와 다른 키를 조합하여 이용
- 편집기 형식
  - <ctrl+x>, <ctrl+c>: 편집 종료
  - <ctrl+c>: emacs 종료
  - <ctrl+s>: 편집 된 내용 저장
  - <ctrl+f>: 커서를 오른쪽으로 이동
  - <ctrl+j>: 행 끝을 나란히 맞춘다

## 프로그램 설치

### 리눅스 배포판과 패키지 관리기법

- RedHat: YUM
- Debian: DPKG
- SuSe: YAST
- **CentOS: RPM**

### RPM(Redhat Package Manager)

- 레드햇 사에서 만들어낸 패키지 관리 툴
- `sendmail-8.14.3-5.fc11.i586.rpm` (패키지 명/버전/릴리즈 번호/페도라 버전/아키텍처)
- 옵션
  - **옵션 `-h`**: 패키지 **설치 과정**을 해시(#) 마크로 표시
  - 옵션 `-V`: 파일이 침입자에 의해 권한 획득이나 변조 되었는지 검사. S(파일 크기), 5(MD5), T(파일 수정일)
  - 옵션 `--force` 포함옵션: replacepkgs(패키지 재설치), replacefiles(강제설치),
    oldpackage(다운그레이드)
  - 옵션 `-e`: 패키지 제거
  - **옵션 `-U`**: 기존 패키지 업그레이드, 설치된 패키지가 존재하지 않으면 새로운 버전 설치
  - 옵션 `-q`: 패키지 설치 여부 확인
  - 옵션 `-l`: 설치되는 파일 목록(list) 출력
  - **옵션 `-i`**: 패키지 파일에 대한 **정보**(information) 출력
  - 옵션 `-a`: 모두
  - 옵션 `-qf`: 질의의 결과를 원하는 형태로 출력 시 사용 (--quaryformat)
  - 옵션 `--nodepes`: 의존성 관계를 무시하고 패키지 설치

### YUM(Yellowdog Updater Modified)

- RPM의 의존성 문제를 해결하기 위한 유틸리티
- 사용법
  - `yum **remove** 패키지명`: 지정한 패키지 제거
  - `yum search 문자열`: 해당 문자열이 포함된 패키지 검색
  - `yum groupinstall 패키지명`: 지정한 패키지 그룹 설치
  - `yum install 패키지명`: 의존성을 고려하며 패키지 설치
  - `yum list`: **전체 패키지**에 대한 정보 출력
  - `yum list update:` 업데이트 시 필요한 패키지 정보
  - `yum info`: **패키지 정보** 출력
  - `yum check-update`: 업데이트가 가능한 패키지 목록 확인
- 최초 설치 시 진행
  - 패키지 설치 전 먼저 지정한 패키지가 설치되었는지 검사 후 해당 패키지를 설치
  - `yum search`후 `yum install [검색결과]` 수행

### dnf

- 페도라 22에서부터 적용된 패키지 관리 도구
- 기존 도구인 yum의 문제점을 보완한 도구

### dpkg

- 데비안의 저(low)레벨 패키지 관리 툴, deb 패키지의 설치, 삭제, 정보 제공을 위해 사용됨
- 파일형식: 패키지이름*버전*릴리즈번호\_아키텍처.deb
- 옵션
  - **`-s`**: 패키지 **버전**, **관리자**, **간략 설명** 등 **패키지 정보 출력**
  - `-p [패키지]`: 패키지의 환경 설정 파일을 포함하여 모두 제거
  - `-L [패키지]`: 설치된 모든 파일 목록들을 출력

### apt-get(advanced packaging tool get)

- 데미안 리눅스에서 소프트웨어 설치와 제거를 위한 패키지 관리 유틸리티
- `/etc/apt/sources.list`: 패키지 정보를 확인, 설치 시 발생되는 의존성/충돌 문제를 해결하기 위해 참조
- 패키지 설치: `apt-get install 패키지명`

### aptitude

- 우분투의 패키지 관리 유틸리티, APT 처럼 패키지를 관리 자동화

## 소스 파일 설치

### 파일 아카이브

- 다수 개의 파일이나 디렉터리를 하나의 파일로 묶는 것

### tar

- 사용 방법: `tar [옵션] 파일명`
- 옵션
  - ex) `tar -zxvf home.tgz /home`
  - `x`: **tar 파일**을 풂
  - `z`: 아카이브파일을 **gzip 파일**로 압축 해제
  - `c`: 파일이나 디렉터리를 아카이브(tar)파일로 묶음
  - `f`: 아카이브 **파일명 지정**
  - `v [파일명]`: 작업 대상이 되는 파일의 이름을 지정
  - `v`: 어떤 명령을 실행할 때 대상이 되고 있는 파일들의 **처리 과정을 화면에 출력**
  - `t`: tar(아카이브 파일) 안에 묶여있는 파일 목록 출력
  - `P`: **절대 경로**로 정보 출력
  - `r`: **기존 tar 파일 뒤에 파일 추가**
  - `j`: **압축 파일인 tar.bz2에 사용**
  - `J`: xz 옵션으로 압축 파일인 tar.xz에 사용
  - `C`: **디렉터리 변경**
- 압축 명령과 압축 해제 명령 조합
- zcat: 압축되어 있는 텍스트 파일 내용 확

### 파일 압축과 해제

- compress, uncompress (압축 명: `.Z`)
- gzip, gunzip (압축 명: `.gz`)
- bzip, bunzip (압축 명: `.bz2`)
- xz, unxz (압축 명: `.xz`), 옵션 `-d`(압축 해제)
- 압축률 순위: gzip < bz2 < xz

### 소스코드 설치

- 컴파일 순서 : configure -> make -> make install
- CMake(Cross Platform Make)
  - 스스로 기존의 make과정을 수행하지 않고 지정한 운영 체제에 맞는 make 파일의 생성만 수행
